schema: '2.0'
stages:
  preprocess_fatura:
    cmd: python src/stages/preprocess_fatura.py
    deps:
    - path: data/raw/FATURA
      hash: md5
      md5: 0f9fde2f47c4300dd3f931eab0f935bf.dir
      size: 473677037
      nfiles: 40004
    - path: src/stages/preprocess_fatura.py
      hash: md5
      md5: eab2b5047c84efb1ed75e40c589389d1
      size: 1001
    outs:
    - path: data/processed/fatura_ocr.csv
      hash: md5
      md5: fc39caaf6c352eebc951a82ff95437e7
      size: 6400008
  preprocess_enterprise:
    cmd: python src/stages/preprocess_fatura_enterprise.py
    deps:
    - path: data/raw/FATURA
      hash: md5
      md5: 5c0c7bb55dea612654b412ebd40a6f4e.dir
      size: 473677069
      nfiles: 40005
    - path: src/stages/preprocess_fatura_enterprise.py
      hash: md5
      md5: 2ac5e261a198bacf5478a081b315839b
      size: 23496
    outs:
    - path: data/processed/fatura_enterprise_preprocessed.csv
      hash: md5
      md5: b8cb1fd8f73c8311074f861170c9c576
      size: 5086182
  prepare_training:
    cmd: python src/training/prepare_training_data.py
    deps:
    - path: data/processed/fatura_enterprise_preprocessed.csv
      hash: md5
      md5: b8cb1fd8f73c8311074f861170c9c576
      size: 5086182
    - path: src/training/prepare_training_data.py
      hash: md5
      md5: c0d18ff4e208a646aa6da27fc73389e8
      size: 8027
    outs:
    - path: data/processed/failure_training.csv
      hash: md5
      md5: 2c558003f732cb3165629765cd45ac26
      size: 3115886
    - path: data/processed/quality_training.csv
      hash: md5
      md5: 6e9d1b5b5f2605dd15c4fa66818807a6
      size: 2211629
  train_models:
    cmd: python src/training/train_all_models.py
    deps:
    - path: data/processed/failure_training.csv
      hash: md5
      md5: 2c558003f732cb3165629765cd45ac26
      size: 3115886
    - path: data/processed/quality_training.csv
      hash: md5
      md5: 6e9d1b5b5f2605dd15c4fa66818807a6
      size: 2211629
    - path: src/training/train_all_models.py
      hash: md5
      md5: 8147297cd435e432c4063504fb245a43
      size: 18087
    outs:
    - path: models/failure_model.pkl
      hash: md5
      md5: cf83093502623e3dc921fe54f9cf8197
      size: 5002737
    - path: models/quality_model.pkl
      hash: md5
      md5: 1e65517a17e1c203043afcf224d702eb
      size: 356094
    - path: reports/model_leaderboard.json
      hash: md5
      md5: 0c18b969461f897619b746aa76d26a64
      size: 1401
  evaluate_models:
    cmd: python src/training/evaluate_models.py
    deps:
    - path: data/processed/failure_training.csv
      hash: md5
      md5: 2c558003f732cb3165629765cd45ac26
      size: 3115886
    - path: data/processed/quality_training.csv
      hash: md5
      md5: 6e9d1b5b5f2605dd15c4fa66818807a6
      size: 2211629
    - path: models/failure_model.pkl
      hash: md5
      md5: cf83093502623e3dc921fe54f9cf8197
      size: 5002737
    - path: models/quality_model.pkl
      hash: md5
      md5: 1e65517a17e1c203043afcf224d702eb
      size: 356094
    - path: src/training/evaluate_models.py
      hash: md5
      md5: adac08dc445e2191eafc641415043772
      size: 14356
    outs:
    - path: reports/failure_best_roc.png
      hash: md5
      md5: d100f11f9689808df3dadd47312c5a5a
      size: 32279
    - path: reports/failure_perm_importance.png
      hash: md5
      md5: 7d6be5a54bbc1508a56514d4da0fad5e
      size: 37901
    - path: reports/quality_best_roc.png
      hash: md5
      md5: 88bf7093608869a53cd61e83fe50c4a2
      size: 32303
    - path: reports/quality_perm_importance.png
      hash: md5
      md5: fb40fd6a2e812c451ffe7b769fa7572f
      size: 41077
  error_analysis:
    cmd: python src/training/error_analysis.py
    deps:
    - path: data/processed/failure_training.csv
      hash: md5
      md5: 2c558003f732cb3165629765cd45ac26
      size: 3115886
    - path: data/processed/quality_training.csv
      hash: md5
      md5: 6e9d1b5b5f2605dd15c4fa66818807a6
      size: 2211629
    - path: models/failure_model.pkl
      hash: md5
      md5: cf83093502623e3dc921fe54f9cf8197
      size: 5002737
    - path: models/quality_model.pkl
      hash: md5
      md5: 1e65517a17e1c203043afcf224d702eb
      size: 356094
    - path: src/training/error_analysis.py
      hash: md5
      md5: 1ff5fe8df13bc852e246b43e24c33655
      size: 11072
    outs:
    - path: reports/error_analysis/failure_false_negatives.csv
      hash: md5
      md5: b74eb40a575ce533b2feae5bf54d4ac5
      size: 62456
    - path: reports/error_analysis/failure_false_positives.csv
      hash: md5
      md5: 004afcf8cdce18fbe652c0149c9302dc
      size: 19373
    - path: reports/error_analysis/quality_false_negatives.csv
      hash: md5
      md5: d9d7706f21b87d86bb7d1ee510229bb6
      size: 42001
    - path: reports/error_analysis/quality_false_positives.csv
      hash: md5
      md5: bd8e15058d9c82b4812018f851050d63
      size: 13625
  generate_summary:
    cmd: python src/reporting/generate_summary_report.py
    deps:
    - path: reports/model_leaderboard.json
      hash: md5
      md5: 0c18b969461f897619b746aa76d26a64
      size: 1401
    - path: src/reporting/generate_summary_report.py
      hash: md5
      md5: ada6b9e4a6803c5d2ba2236bd5251016
      size: 2191
    outs:
    - path: reports/summary_report.txt
      hash: md5
      md5: 7bdcc956e2a85b23a19446dbfbea2451
      size: 322
